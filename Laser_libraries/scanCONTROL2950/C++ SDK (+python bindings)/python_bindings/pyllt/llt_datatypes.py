#
# scanCONTROL Windows Python Bindings
#
# MIT License
#
# Copyright Â© 2017-2018 Micro-Epsilon Messtechnik GmbH & Co. KG
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:

# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.

# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#

import ctypes as ct
from enum import IntEnum

# Convert Data
CONVERT_X = 0x00000800
CONVERT_Z = 0x00001000
CONVERT_WIDTH = 0x00000100
CONVERT_MAXIMUM = 0x00000200
CONVERT_THRESHOLD = 0x00000400
CONVERT_M0 = 0x00002000
CONVERT_M1 = 0x00004000

# RS422 Interface Function
RS422_INTERFACE_FUNCTION_AUTO_27xx = 0
RS422_INTERFACE_FUNCTION_SERIALPORT_115200_27xx = 1
RS422_INTERFACE_FUNCTION_TRIGGER_27xx = 2
RS422_INTERFACE_FUNCTION_CMM_TRIGGER_27xx = 3
RS422_INTERFACE_FUNCTION_ENCODER_27xx = 4
RS422_INTERFACE_FUNCTION_DIGITAL_OUTPUT_27xx = 6
RS422_INTERFACE_FUNCTION_TRIGGER_LASER_PULSE_27xx = 7
RS422_INTERFACE_FUNCTION_SERIALPORT_57600_27xx = 8
RS422_INTERFACE_FUNCTION_SERIALPORT_38400_27xx = 9
RS422_INTERFACE_FUNCTION_SERIALPORT_19200_27xx = 10
RS422_INTERFACE_FUNCTION_SERIALPORT_9600_27xx = 11
RS422_INTERFACE_FUNCTION_SERIALPORT_115200 = 0
RS422_INTERFACE_FUNCTION_SERIALPORT_57600 = 1
RS422_INTERFACE_FUNCTION_SERIALPORT_38400 = 2
RS422_INTERFACE_FUNCTION_SERIALPORT_19200 = 3
RS422_INTERFACE_FUNCTION_SERIALPORT_9600 = 4
RS422_INTERFACE_FUNCTION_TRIGGER_INPUT = 5
RS422_INTERFACE_FUNCTION_TRIGGER_OUTPUT = 6
RS422_INTERFACE_FUNCTION_CMM_TRIGGER = 7

ERROR_OK = 0
ERROR_SERIAL_COMM = 1
ERROR_SERIAL_LLT = 7
ERROR_CONNECTIONLOST = 10
ERROR_STOPSAVING = 100

IS_FUNC_NO = 0
IS_FUNC_YES = 1

# General return data
GENNERAL_FUNCTION_DEVICE_NAME_NOT_SUPPORTED = 4
GENERAL_FUNCTION_PACKET_SIZE_CHANGED = 3
GENERAL_FUNCTION_CONTAINER_MODE_HEIGHT_CHANGED = 2
GENERAL_FUNCTION_OK = 1
GENERAL_FUNCTION_NOT_AVAILABLE = 0

# Error variables
ERROR_GENERAL_WHILE_LOAD_PROFILE = -1000
ERROR_GENERAL_NOT_CONNECTED = -1001
ERROR_GENERAL_DEVICE_BUSY = -1002
ERROR_GENERAL_WHILE_LOAD_PROFILE_OR_GET_PROFILES = -1003
ERROR_GENERAL_WHILE_GET_PROFILES = -1004
ERROR_GENERAL_GET_SET_ADDRESS = -1005
ERROR_GENERAL_POINTER_MISSING = -1006
ERROR_GENERAL_WHILE_SAVE_PROFILES = -1007
ERROR_GENERAL_SECOND_CONNECTION_TO_LLT = -1008
ERROR_GETDEVICENAME_SIZE_TOO_LOW = -1
ERROR_GETDEVICENAME_NO_BUFFER = -2
ERROR_LOADSAVE_WRITING_LAST_BUFFER = -50
ERROR_LOADSAVE_WHILE_SAVE_PROFILE = -51
ERROR_LOADSAVE_NO_PROFILELENGTH_POINTER = -52
ERROR_LOADSAVE_NO_LOAD_PROFILE = -53
ERROR_LOADSAVE_STOP_ALREADY_LOAD = -54
ERROR_LOADSAVE_CANT_OPEN_FILE = -55
ERROR_LOADSAVE_FILE_POSITION_TOO_HIGH = -57
ERROR_LOADSAVE_AVI_NOT_SUPPORTED = -58
ERROR_LOADSAVE_NO_REARRANGEMENT_POINTER = -59
ERROR_LOADSAVE_WRONG_PROFILE_CONFIG = -60
ERROR_LOADSAVE_NOT_TRANSFERING = -61
ERROR_PROFTRANS_SHOTS_NOT_ACTIVE = -100
ERROR_PROFTRANS_SHOTS_COUNT_TOO_HIGH = -101
ERROR_PROFTRANS_WRONG_PROFILE_CONFIG = -102
ERROR_PROFTRANS_FILE_EOF = -103
ERROR_PROFTRANS_NO_NEW_PROFILE = -104
ERROR_PROFTRANS_BUFFER_SIZE_TOO_LOW = -105
ERROR_PROFTRANS_NO_PROFILE_TRANSFER = -106
ERROR_PROFTRANS_PACKET_SIZE_TOO_HIGH = -107
ERROR_PROFTRANS_CREATE_BUFFERS = -108
ERROR_PROFTRANS_WRONG_PACKET_SIZE_FOR_CONTAINER = -109
ERROR_PROFTRANS_REFLECTION_NUMBER_TOO_HIGH = -110
ERROR_PROFTRANS_MULTIPLE_SHOTS_ACTIVE = -111
ERROR_PROFTRANS_BUFFER_HANDOUT = -112
ERROR_PROFTRANS_WRONG_BUFFER_POINTER = -113
ERROR_PROFTRANS_WRONG_TRANSFER_CONFIG = -114
ERROR_SETGETFUNCTIONS_WRONG_BUFFER_COUNT = -150
ERROR_SETGETFUNCTIONS_PACKET_SIZE = -151
ERROR_SETGETFUNCTIONS_WRONG_PROFILE_CONFIG = -152
ERROR_SETGETFUNCTIONS_NOT_SUPPORTED_RESOLUTION = -153
ERROR_SETGETFUNCTIONS_REFLECTION_NUMBER_TOO_HIGH = -154
ERROR_SETGETFUNCTIONS_WRONG_FEATURE_ADRESS = -155
ERROR_SETGETFUNCTIONS_SIZE_TOO_LOW = -156
ERROR_SETGETFUNCTIONS_WRONG_PROFILE_SIZE = -157
ERROR_SETGETFUNCTIONS_MOD_4 = -158
ERROR_SETGETFUNCTIONS_REARRANGEMENT_PROFILE = -159
ERROR_SETGETFUNCTIONS_USER_MODE_TOO_HIGH = -160
ERROR_SETGETFUNCTIONS_USER_MODE_FACTORY_DEFAULT = -161
ERROR_SETGETFUNCTIONS_HEARTBEAT_TOO_HIGH = -162
ERROR_POSTPROCESSING_NO_PROF_BUFFER = -200
ERROR_POSTPROCESSING_MOD_4 = -201
ERROR_POSTPROCESSING_NO_RESULT = -202
ERROR_POSTPROCESSING_LOW_BUFFERSIZE = -203
ERROR_POSTPROCESSING_WRONG_RESULT_SIZE = -204
ERROR_GETDEVINTERFACES_WIN_NOT_SUPPORTED = -250
ERROR_GETDEVINTERFACES_REQUEST_COUNT = -251
ERROR_GETDEVINTERFACES_CONNECTED = -252
ERROR_GETDEVINTERFACES_INTERNAL = -253
ERROR_CONNECT_LLT_COUNT = -300
ERROR_CONNECT_SELECTED_LLT = -301
ERROR_CONNECT_ALREADY_CONNECTED = -302
ERROR_CONNECT_LLT_NUMBER_ALREADY_USED = -303
ERROR_CONNECT_SERIAL_CONNECTION = -304
ERROR_CONNECT_INVALID_IP = -305
ERROR_PARTPROFILE_NO_PART_PROF = -350
ERROR_PARTPROFILE_TOO_MUCH_BYTES = -351
ERROR_PARTPROFILE_TOO_MUCH_POINTS = -352
ERROR_PARTPROFILE_NO_POINT_COUNT = -353
ERROR_PARTPROFILE_NOT_MOD_UNITSIZE_POINT = -354
ERROR_PARTPROFILE_NOT_MOD_UNITSIZE_DATA = -355
ERROR_CMMTRIGGER_NO_DIVISOR = -400
ERROR_CMMTRIGGER_TIMEOUT_AFTER_TRANSFERPROFILES = -401
ERROR_CMMTRIGGER_TIMEOUT_AFTER_SETCMMTRIGGER = -402
ERROR_TRANSERRORVALUE_WRONG_ERROR_VALUE = -450
ERROR_TRANSERRORVALUE_BUFFER_SIZE_TOO_LOW = -451
ERROR_READWRITECONFIG_CANT_CREATE_FILE = -500
ERROR_READWRITECONFIG_CANT_OPEN_FILE = -501
ERROR_READWRITECONFIG_QUEUE_TO_SMALL = -502
ERROR_READWRITECONFIG_FILE_EMPTY = -503
ERROR_READWRITECONFIG_UNKNOW_FILE = -504

# Function defines for the Get/SetFeature function (deprecated names)
FEATURE_FUNCTION_SERIAL = 0xf0000410
FEATURE_FUNCTION_FREE_MEASURINGFIELD_Z = 0xf0b02008
FEATURE_FUNCTION_FREE_MEASURINGFIELD_X = 0xf0b0200c
FEATURE_FUNCTION_DYNAMIC_TRACK_DIVISOR = 0xf0b02010
FEATURE_FUNCTION_DYNAMIC_TRACK_FACTOR = 0xf0b02014
FEATURE_FUNCTION_LASERPOWER = 0xf0f00824
INQUIRY_FUNCTION_LASERPOWER = 0xf0f00524
FEATURE_FUNCTION_MEASURINGFIELD = 0xf0f00880
INQUIRY_FUNCTION_MEASURINGFIELD = 0xf0f00580
FEATURE_FUNCTION_SHUTTERTIME = 0xf0f0081c
INQUIRY_FUNCTION_SHUTTERTIME = 0xf0f0051c
FEATURE_FUNCTION_IDLETIME = 0xf0f00800
INQUIRY_FUNCTION_IDLETIME = 0xf0f00500
FEATURE_FUNCTION_PROCESSING_PROFILEDATA = 0xf0f00804
INQUIRY_FUNCTION_PROCESSING_PROFILEDATA = 0xf0f00504
FEATURE_FUNCTION_MAINTENANCEFUNCTIONS = 0xf0f0088c
INQUIRY_FUNCTION_MAINTENANCEFUNCTIONS = 0xf0f0058c
FEATURE_FUNCTION_CMMTRIGGER = 0xf0f00888
INQUIRY_FUNCTION_CMMTRIGGER = 0xf0f00588
FEATURE_FUNCTION_REARRANGEMENT_PROFILE = 0xf0f0080c
INQUIRY_FUNCTION_REARRANGEMENT_PROFILE = 0xf0f0050c
FEATURE_FUNCTION_RS422_INTERFACE_FUNCTION = 0xf0f008c0
INQUIRY_FUNCTION_RS422_INTERFACE_FUNCTION = 0xf0f005c0
FEATURE_FUNCTION_SATURATION = 0xf0f00814
INQUIRY_FUNCTION_SATURATION = 0xf0f00514
FEATURE_FUNCTION_CAPTURE_QUALITY = 0xf0f008c4
INQUIRY_FUNCTION_CAPTURE_QUALITY = 0xf0f005c4
FEATURE_FUNCTION_SHARPNESS = 0xf0f00808
INQUIRY_FUNCTION_SHARPNESS = 0xf0f00508

# status and control register
FEATURE_FUNCTION_SERIAL_NUMBER = 0xf0000410
FEATURE_FUNCTION_CALIBRATION_SCALE = 0xf0a00000
FEATURE_FUNCTION_CALIBRATION_OFFSET = 0xf0a00004
FEATURE_FUNCTION_PEAKFILTER_WIDTH = 0xf0b02000
FEATURE_FUNCTION_PEAKFILTER_HEIGHT = 0xf0b02004
FEATURE_FUNCTION_ROI1_DISTANCE = 0xf0b02008
FEATURE_FUNCTION_ROI1_POSITION = 0xf0b0200c
FEATURE_FUNCTION_ROI1_TRACKING_DIVISOR = 0xf0b02010
FEATURE_FUNCTION_ROI1_TRACKING_FACTOR = 0xf0b02014
FEATURE_FUNCTION_CALIBRATION_0 = 0xf0b02020
FEATURE_FUNCTION_CALIBRATION_1 = 0xf0b02024
FEATURE_FUNCTION_CALIBRATION_2 = 0xf0b02028
FEATURE_FUNCTION_CALIBRATION_3 = 0xf0b0202c
FEATURE_FUNCTION_CALIBRATION_4 = 0xf0b02030
FEATURE_FUNCTION_CALIBRATION_5 = 0xf0b02034
FEATURE_FUNCTION_CALIBRATION_6 = 0xf0b02038
FEATURE_FUNCTION_CALIBRATION_7 = 0xf0b0203c
FEATURE_FUNCTION_IMAGE_FEATURES = 0xf0b02100
FEATURE_FUNCTION_ROI2_DISTANCE = 0xf0b02104
FEATURE_FUNCTION_ROI2_POSITION = 0xf0b02108
FEATURE_FUNCTION_RONI_DISTANCE = 0xf0b0210c
FEATURE_FUNCTION_RONI_POSITION = 0xf0b02110
FEATURE_FUNCTION_EA_REFERENCE_REGION_DISTANCE = 0xf0b02114
FEATURE_FUNCTION_EA_REFERENCE_REGION_POSITION = 0xf0b02118
FEATURE_FUNCTION_LASER = 0xf0f00824
INQUIRY_FUNCTION_LASER = 0xf0f00524
FEATURE_FUNCTION_ROI1_PRESET = 0xf0f00880
INQUIRY_FUNCTION_ROI1_PRESET = 0xf0f00580
FEATURE_FUNCTION_TRIGGER = 0xf0f00830
INQUIRY_FUNCTION_TRIGGER = 0xf0f00530
FEATURE_FUNCTION_EXPOSURE_AUTOMATIC_LIMITS = 0xf0f00834
INQUIRY_FUNCTION_EXPOSURE_AUTOMATIC_LIMITS = 0xf0f00534
FEATURE_FUNCTION_EXPOSURE_TIME = 0xf0f0081c
INQUIRY_FUNCTION_EXPOSURE_TIME = 0xf0f0051c
FEATURE_FUNCTION_IDLE_TIME = 0xf0f00800
INQUIRY_FUNCTION_IDLE_TIME = 0xf0f0050
FEATURE_FUNCTION_PROFILE_PROCESSING = 0xf0f00804
INQUIRY_FUNCTION_PROFILE_PROCESSING = 0xf0f00504
FEATURE_FUNCTION_THRESHOLD = 0xf0f00810
INQUIRY_FUNCTION_THRESHOLD = 0xf0f00510
FEATURE_FUNCTION_MAINTENANCE = 0xf0f0088c
INQUIRY_FUNCTION_MAINTENANCE = 0xf0f0058c
FEATURE_FUNCTION_CMM_TRIGGER = 0xf0f00888
INQUIRY_FUNCTION_CMM_TRIGGER = 0xf0f00588
FEATURE_FUNCTION_PROFILE_REARRANGEMENT = 0xf0f0080c
INQUIRY_FUNCTION_PROFILE_REARRANGEMENT = 0xf0f0050c
FEATURE_FUNCTION_PROFILE_FILTER = 0xf0f00818
INQUIRY_FUNCTION_PROFILE_FILTER = 0xf0f00518
FEATURE_FUNCTION_DIGITAL_IO = 0xf0f008c0
INQUIRY_FUNCTION_DIGITAL_IO = 0xf0f005c0
FEATURE_FUNCTION_TEMPERATURE = 0xf0f0082c
INQUIRY_FUNCTION_TEMPERATURE = 0xf0f0052c
FEATURE_FUNCTION_EXTRA_PARAMETER = 0xf0f00808
INQUIRY_FUNCTION_EXTRA_PARAMETER = 0xf0f00508
FEATURE_FUNCTION_PACKET_DELAY = 0x00000d08
FEATURE_FUNCTION_SATURATION = 0xf0f00814
INQUIRY_FUNCTION_SATURATION = 0xf0f00514
FEATURE_FUNCTION_CAPTURE_QUALITY = 0xf0f008c4
INQUIRY_FUNCTION_CAPTURE_QUALITY = 0xf0f005c4

# processing flags
PROC_HIGH_RESOLUTION = 1
PROC_CALIBRATION = (1 << 1)
PROC_MULTIREFL_ALL = (0 << 2)
PROC_MULITREFL_FIRST = (1 << 2)
PROC_MULITREFL_LAST = (2 << 2)
PROC_MULITREFL_LARGESTAREA = (3 << 2)
PROC_MULITREFL_MAXINTENS = (4 << 2)
PROC_MULITREFL_SINGLE = (5 << 2)
PROC_POSTPROCESSING_ON = (1 << 5)
PROC_FLIP_DISTANCE = (1 << 6)
PROC_FLIP_POSITION = (1 << 7)
PROC_AUTOSHUTTER_DELAY = (1 << 8)
PROC_SHUTTERALIGN_CENTER = (0 << 9)
PROC_SHUTTERALIGN_RIGHT = (1 << 9)
PROC_SHUTTERALIGN_LEFT = (2 << 9)
PROC_SHUTTERALIGN_OFF = (3 << 9)
PROC_AUTOSHUTTER_ADVANCED = (1 << 11)

# threshold flags
THRESHOLD_AUTOMATIC = (1 << 24)
THRESHOLD_VIDEO_FILTER = (1 << 11)
THRESHOLD_AMBIENT_LIGHT_SUPPRESSION = (1 << 10)
# threshold flags = (deprecated names)
THRESHOLD_DYNAMIC = (1 << 24)
THRESHOLD_BACKGROUND_FILTER = (1 << 10)

# exposure flags
EXPOSURE_AUTOMATIC = (1 << 24)
# shutter flags = (deprecated names)
SHUTTER_AUTOMATIC = (1 << 24)

# laser power flags
LASER_OFF = 0
LASER_REDUCED_POWER = 1
LASER_FULL_POWER = 2
LASER_PULSE_MODE = (1 << 11)
# deprecated
LASER_PULSMODE = (1 << 11)

# temperature register
TEMP_PREPARE_VALUE = 0x86000000

# trigger flags
TRIG_MODE_EDGE = (0 << 16)
TRIG_MODE_PULSE = (1 << 16)
TRIG_MODE_GATE = (2 << 16)
TRIG_MODE_ENCODER = (3 << 16)
TRIG_INPUT_RS422 = (0 << 21)
TRIG_INPUT_DIGIN = (1 << 21)
TRIG_POLARITY_LOW = (0 << 24)
TRIG_POLARITY_HIGH = (1 << 24)
TRIG_EXT_ACTIVE = (1 << 25)
TRIG_INTERNAL = 0

# region Of interest 1 flags
ROI1_FREE_REGION = (1 << 11)
# measuring field flags = (deprecated names)
MEASFIELD_ACTIVATE_FREE = (1 << 11)

# image features flags
ROI2_ENABLE = 1
RONI_ENABLE = (1 << 1)
EA_REF_REGION_ENABLE = (1 << 2)
FAST_MODE_ENABLE = (1 << 30)
HDR_ENABLE = (1 << 31)

# Maintenance flags
MAINTENANCE_COMPRESS_DATA = 1
MAINTENANCE_LOOPBACK = (1 << 1)
MAINTENANCE_ENCODER_ACTIVE = (1 << 3)
MAINTENANCE_SUPPRESS_REGISTER_RESET = (1 << 5)
MAINTENANCE_UM_LOAD_VIA_DIGIN = (0 << 6)
MAINTENANCE_UM_SUPPRESS_UNTIL_REBOOT = (1 << 6)
MAINTENANCE_UM_SUPPRESS_UNTIL_GVCP_CLOSE = (2 << 6)
MAINTENANCE_UM_SUPPRESS_UNTIL_REBOOT_GVCP_CLOSE = (3 << 6)

# Multiport flags
MULTI_LEVEL_5V = (0 << 11)
MULTI_LEVEL_24V = (1 << 11)
MULTI_INPUT_PULLUP = (0 << 8)
MULTI_INPUT_PULLDOWN = (1 << 8)
MULTI_RS422_TERM_ON = (0 << 10)
MULTI_RS422_TERM_OFF = (1 << 10)
MULTI_ENCODER_BIDIRECT = (0 << 9)
MULTI_ENCODER_UNIDIRECT = (1 << 9)
MULTI_DIGIN_ENC_INDEX = (0 << 4)
MULTI_DIGIN_ENC_TRIG = (1 << 4)
MULTI_DIGIN_TRIG_ONLY = (2 << 4)
MULTI_DIGIN_TRIG_UM = (3 << 4)
MULTI_DIGIN_UM = (4 << 4)
MULTI_DIGIN_TS = (5 << 4)
MULTI_DIGIN_FRAMETRIG_BI = (6 << 4)
MULTI_DIGIN_FRAMETRIG_UNI = (7 << 4)
MULTI_DIGIN_GATED_ENCODER = (8 << 4)
MULTI_DIGIN_TRIG_UM2_TS1 = (9 << 4)
MULTI_DIGIN_UM3_TS1 = (10 << 4)
MULTI_DIGIN_UM2_TS2 = (11 << 4)
MULTI_RS422_115200 = 0
MULTI_RS422_57600 = 1
MULTI_RS422_38400 = 2
MULTI_RS422_19200 = 3
MULTI_RS422_9600 = 4
MULTI_RS422_TRIG_IN = 5
MULTI_RS422_TRIG_OUT = 6
MULTI_RS422_CMM = 7

RS422_INTERFACE_FUNCTION_AUTO_27xx = 0
RS422_INTERFACE_FUNCTION_SERIALPORT_115200_27xx = 1
RS422_INTERFACE_FUNCTION_TRIGGER_27xx = 2
RS422_INTERFACE_FUNCTION_CMM_TRIGGER_27xx = 3
RS422_INTERFACE_FUNCTION_ENCODER_27xx = 4
RS422_INTERFACE_FUNCTION_DIGITAL_OUTPUT_27xx = 6
RS422_INTERFACE_FUNCTION_TRIGGER_LASER_PULSE_27xx = 7
RS422_INTERFACE_FUNCTION_SERIALPORT_57600_27xx = 8
RS422_INTERFACE_FUNCTION_SERIALPORT_38400_27xx = 9
RS422_INTERFACE_FUNCTION_SERIALPORT_19200_27xx = 10
RS422_INTERFACE_FUNCTION_SERIALPORT_9600_27xx = 11

# Profile filter flags
FILTER_RESAMPLE_EXTRAPOLATE_POINTS = (1 << 11)
FILTER_RESAMPLE_ALL_INFO = (1 << 10)
FILTER_RESAMPLE_DISABLED = (0 << 4)
FILTER_RESAMPLE_TINY = (1 << 4)
FILTER_RESAMPLE_VERYSMALL = (2 << 4)
FILTER_RESAMPLE_SMALL = (3 << 4)
FILTER_RESAMPLE_MEDIUM = (4 << 4)
FILTER_RESAMPLE_LARGE = (5 << 4)
FILTER_RESAMPLE_VERYLARGE = (6 << 4)
FILTER_RESAMPLE_HUGE = (7 << 4)
FILTER_MEDIAN_DISABLED = (0 << 2)
FILTER_MEDIAN_3 = (1 << 2)
FILTER_MEDIAN_5 = (2 << 2)
FILTER_MEDIAN_7 = (3 << 2)
FILTER_AVG_DISABLED = 0
FILTER_AVG_3 = 1
FILTER_AVG_5 = 2
FILTER_AVG_7 = 3

# Container flags
CONTAINER_STRIPE_4 = (1 << 23)
CONTAINER_STRIPE_3 = (1 << 22)
CONTAINER_STRIPE_2 = (1 << 21)
CONTAINER_STRIPE_1 = (1 << 20)
CONTAINER_JOIN = (1 << 19)
CONTAINER_DATA_SIGNED = (1 << 18)
CONTAINER_DATA_LSBF = (1 << 17)
CONTAINER_DATA_TS = (1 << 11)
CONTAINER_DATA_EMPTYFIELD4TS = (1 << 10)
CONTAINER_DATA_LOOPBACK = (1 << 9)
CONTAINER_DATA_MOM1U = (1 << 8)
CONTAINER_DATA_MOM1L = (1 << 7)
CONTAINER_DATA_MOM0U = (1 << 6)
CONTAINER_DATA_MOM0L = (1 << 5)
CONTAINER_DATA_WIDTH = (1 << 4)
CONTAINER_DATA_INTENS = (1 << 3)
CONTAINER_DATA_THRES = (1 << 2)
CONTAINER_DATA_X = (1 << 1)
CONTAINER_DATA_Z = (1 << 0)

# Structs
class TPartialProfile(ct.Structure):
    _fields_ = [('nStartPoint', ct.c_uint),
                ('nStartPointData', ct.c_uint),
                ('nPointCount', ct.c_uint),
                ('nPointDataWidth', ct.c_uint)]


# Enums
class CtypesEnum(IntEnum):
    """A ctypes-compatible IntEnum superclass."""

    @classmethod
    def from_param(cls, obj):
        return obj


class TScannerType(CtypesEnum):
    scanCONTROL28xx_25 = 0
    scanCONTROL28xx_100 = 1
    scanCONTROL28xx_10 = 2

    scanCONTROL27xx_25 = 1000
    scanCONTROL27xx_100 = 1001
    scanCONTROL27xx_50 = 1002

    scanCONTROL26xx_25 = 2000
    scanCONTROL26xx_100 = 2001
    scanCONTROL26xx_50 = 2002
    scanCONTROL26xx_10 = 2003

    scanCONTROL29xx_25 = 3000
    scanCONTROL29xx_100 = 3001
    scanCONTROL29xx_50 = 3002
    scanCONTROL29xx_10 = 3003

    scanCONTROL30xx_25 = 4000
    scanCONTROL30xx_50 = 4001
	scanCONTROL30xx_200 = 4002
    scanCONTROL30xx_xxx = 4999
	
	scanCONTROL25xx_25 = 5000
    scanCONTROL25xx_100 = 5001
    scanCONTROL25xx_50 = 5002
    scanCONTROL25xx_10 = 5003
    scanCONTROL25xx_xxx = 5999

    scanCONTROL2xxx = 6000


class TFileType(CtypesEnum):
    AVI = 0
    LLT = 1
    CSV = 2
    BMP = 3
    CSV_NEG = 4


class TCallbackType(CtypesEnum):
    STD_CALL = 0
    C_DECL = 1


class TProfileConfig(CtypesEnum):
    NONE = 0
    PROFILE = 1
    CONTAINER = 1
    VIDEO_IMAGE = 1
    PURE_PROFILE = 2
    QUARTER_PROFILE = 3
    CSV_PROFILE = 4
    PARTIAL_PROFILE = 5


class TTransferProfileType(CtypesEnum):
    NORMAL_TRANSFER = 0
    SHOT_TRANSFER = 1
    NORMAL_CONTAINER_MODE = 2
    SHOT_CONTAINER_MODE = 3
    NONE_TRANSFER = 4


class TInterfaceType(CtypesEnum):
    INTF_TYPE_UNKNOWN = 0
    INTF_TYPE_SERIAL = 1
    INTF_TYPE_FIREWIRE = 2
    INTF_TYPE_ETHERNET = 3


class TTransferVideoType(CtypesEnum):
    VIDEO_MODE_0 = 0
    VIDEO_MODE_1 = 1
    NONE_VIDEOMODE = 2
